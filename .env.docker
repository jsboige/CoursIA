# =============================================================================
# CoursIA GenAI - Configuration Docker (Development Mode)
# =============================================================================
# Variables d'environnement pour les services Docker GenAI
# Mode: Development (ressources optimisées pour machine locale)
#
# ⚠️ IMPORTANT: Ce fichier contient UNIQUEMENT les variables Docker
# Les clés API externes (OpenRouter, etc.) sont gérées séparément
# =============================================================================

# ===== ENVIRONMENT =====
GENAI_ENVIRONMENT=development
COMPOSE_PROJECT_NAME=coursia-genai
COMPOSE_FILE_VERSION=3.8

# ===== DOCKER CONFIGURATION =====
DOCKER_API_VERSION=1.41

# ===== SERVICE PORTS =====
# Ports principaux des services GenAI
GENAI_PORT_FLUX=8189
GENAI_PORT_SD35=8190
GENAI_PORT_COMFYUI=8191
GENAI_PORT_ORCHESTRATOR=8193

# ===== FLUX.1-DEV CONFIGURATION (DEVELOPMENT) =====
# Ressources allouées pour FLUX.1-dev
FLUX_MEMORY_LIMIT=8GB
FLUX_CPU_LIMIT=4.0
FLUX_GPU_MEMORY_LIMIT=8GB
FLUX_CPU_THREADS=4
FLUX_BATCH_SIZE=1
FLUX_PRECISION=fp16

# ===== STABLE DIFFUSION 3.5 CONFIGURATION (DEVELOPMENT) =====
# Ressources allouées pour Stable Diffusion 3.5
SD35_MEMORY_LIMIT=12GB
SD35_CPU_LIMIT=6.0
SD35_GPU_MEMORY_LIMIT=10GB
SD35_BATCH_SIZE=1
SD35_PRECISION=fp16

# ===== COMFYUI WORKFLOWS CONFIGURATION (DEVELOPMENT) =====
# Ressources allouées pour ComfyUI Workflows
COMFYUI_MEMORY_LIMIT=4GB
COMFYUI_CPU_LIMIT=3.0
COMFYUI_GPU_MEMORY_LIMIT=3GB

# ===== ORCHESTRATOR CONFIGURATION (DEVELOPMENT) =====
# Configuration de l'orchestrateur Docker
ORCHESTRATOR_MEMORY_LIMIT=2GB
ORCHESTRATOR_CPU_LIMIT=2.0
MAX_CONCURRENT_MODELS=2

# ===== VOLUMES PATHS =====
# Chemins des volumes Docker (relatifs au projet)
GENAI_MODELS_PATH=./docker-configurations/models
GENAI_OUTPUTS_PATH=./docker-configurations/outputs
GENAI_CACHE_PATH=./docker-configurations/cache

# ===== LOGGING CONFIGURATION =====
# Configuration des logs Docker
LOG_LEVEL=DEBUG
LOG_DRIVER=json-file
LOG_MAX_SIZE=10m
LOG_MAX_FILES=3
VERBOSE_LOGGING=true
DEBUG_MODE=true

# ===== HEALTH CHECK CONFIGURATION =====
# Health checks pour tous les services
HEALTH_CHECK_ENABLED=true
HEALTH_CHECK_INTERVAL=30s
HEALTH_CHECK_TIMEOUT=10s
HEALTH_CHECK_RETRIES=3
HEALTH_CHECK_START_PERIOD=60s

# ===== SECURITY (DEVELOPMENT) =====
# Sécurité allégée pour développement local
GENAI_API_AUTH_ENABLED=false
CORS_ENABLED=true
CORS_ALLOW_ALL_ORIGINS=true
SECURITY_ENABLED=false

# ===== NETWORK CONFIGURATION =====
# Configuration réseau Docker
GENAI_NETWORK_NAME=genai-dev-network
GENAI_NETWORK_SUBNET=172.20.0.0/16
GENAI_NETWORK_GATEWAY=172.20.0.1

# IP addresses des services
ORCHESTRATOR_IP=172.20.0.10
FLUX_IP=172.20.0.11
SD35_IP=172.20.0.12
COMFYUI_IP=172.20.0.13

# ===== RESTART POLICIES =====
RESTART_POLICY=unless-stopped

# ===== CUDA / GPU CONFIGURATION =====
# Configuration CUDA pour tous les services GPU
CUDA_VISIBLE_DEVICES=0
NVIDIA_VISIBLE_DEVICES=0

# ===== DEVELOPMENT SECRETS =====
# Secrets de développement (NON-PRODUCTION, pour tests locaux uniquement)
GENAI_API_KEY=dev_genai_key_coursia_2025

# =============================================================================
# NOTES DE CONFIGURATION:
#
# 1. RESSOURCES DEVELOPMENT:
#    - Total RAM: ~26GB (FLUX 8GB + SD35 12GB + ComfyUI 4GB + Orchestrator 2GB)
#    - Total CPU: ~15 cores
#    - GPU: Partagé entre tous les services (CUDA_VISIBLE_DEVICES=0)
#
# 2. PORTS UTILISÉS:
#    - 8189: FLUX.1-dev (ComfyUI)
#    - 8190: Stable Diffusion 3.5
#    - 8191: ComfyUI Workflows
#    - 8193: Orchestrator API
#
# 3. VOLUMES:
#    - models: Modèles partagés (lecture seule pour sécurité)
#    - outputs: Sorties générées (lecture/écriture)
#    - cache: Cache HuggingFace et autres (lecture/écriture)
#
# 4. SÉCURITÉ DEVELOPMENT:
#    - Authentification désactivée (API_AUTH_ENABLED=false)
#    - CORS ouvert (CORS_ALLOW_ALL_ORIGINS=true)
#    - Logs en mode DEBUG
#
# 5. POUR PASSER EN PRODUCTION:
#    - Créer un fichier .env.docker.production
#    - Augmenter les ressources (voir docs/genai-environment-configurations.md)
#    - Activer la sécurité (GENAI_API_AUTH_ENABLED=true)
#    - Réduire les logs (LOG_LEVEL=INFO)
#
# =============================================================================